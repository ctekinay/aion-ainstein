# =============================================================================
# AION-AINSTEIN Routing Policy
# =============================================================================
# Centralized runtime configuration for routing behavior.
# All flags can be overridden via environment variables (AINSTEIN_ prefix).
#
# Usage:
#   - Toggle flags here or via env vars to isolate routing changes
#   - Use transparency logs to trace which flag caused which route
#   - Set strict_mode_enabled: false to relax keyword-triggered routing
# =============================================================================

# ---- Master Switches ----

# Strict mode: when true, keyword-triggered deterministic routes fire
# (list detection, approval detection, scope gating).
# When false, all queries go through intent router → Elysia Tree path.
strict_mode_enabled: true

# Intent router: when true, classify_intent() runs BEFORE legacy routing.
# The intent decision is logged and used to route if confidence is high enough.
intent_router_enabled: false

# Intent router implementation: "heuristic" (fast, regex) or "llm" (uses LLM)
intent_router_mode: heuristic

# ---- Route-Level Toggles ----

# Follow-up binding: resolve "list them" → "list dars" from conversation context
followup_binding_enabled: true

# Catalog short-circuit: deterministic list/count routes bypass Elysia Tree
catalog_short_circuit_enabled: true

# Abstain gate: reject answers when retrieval quality is poor
abstain_gate_enabled: true

# List route requires list intent: only trigger list tools when the intent
# classifier confirms list intent (prevents "What is an ADR?" → list)
list_route_requires_list_intent: true

# ---- Tree Configuration ----

# Maximum seconds before Elysia Tree times out and falls back to direct query
max_tree_seconds: 120

# Enable/disable Elysia Tree entirely. When false, all queries use
# direct retrieval + LLM generation (useful for "bare LLM + retrieval" experiments)
tree_enabled: true

# ---- Intent Router Tuning ----

# Confidence threshold below which the router asks a clarifying question
# instead of guessing the route
intent_confidence_threshold: 0.55

# ---- Debug / Transparency ----

# Append routing debug footer to web UI responses (dev only)
# Shows: route, intent, confidence, collections queried
debug_headers_enabled: false
